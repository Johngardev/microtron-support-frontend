<section class="p-4">
  <div class="flex items-center justify-between mb-4 text-lg font-bold">
    <h2 mat-dialog-title>
      {{ data?.user ? 'Editar Usuario' : 'Nuevo Usuario' }}
    </h2>
    <button mat-icon-button (click)="onCancel()">
      <mat-icon>close</mat-icon>
    </button>
  </div>

  <mat-dialog-content>
    <form [formGroup]="userForm" (ngSubmit)="onSubmit()" class="form-container">
      <!--Nombre-->
      <mat-form-field class="form-field">
        <mat-label>Nombre completo</mat-label>
        <input matInput formControlName="name" required>
        @if (userForm.get('name')?.hasError('required')) {
        <mat-error>El nombre es requerido</mat-error>
        }
        @if (userForm.get('name')?.hasError('minlength')) {
        <mat-error>El nombre debe tener al menos 3 caracteres</mat-error>
        }
      </mat-form-field>

      <!--Correo Electronico-->
      <mat-form-field class="form-field">
        <mat-label>Correo electrónico</mat-label>
        <input matInput formControlName="email" required>
        @if (userForm.get('email')?.hasError('required')) {
        <mat-error>El correo electrónico es requerido</mat-error>
        }
        @if (userForm.get('email')?.hasError('email')) {
        <mat-error>El correo electrónico no es válido</mat-error>
        }
      </mat-form-field>

      <!--Telefono-->
      <mat-form-field class="form-field">
        <mat-label>Teléfono</mat-label>
        <input matInput formControlName="phone">
      </mat-form-field>

      <!--Empresa-->
      <mat-form-field class="form-field">
        <mat-label>Empresa</mat-label>
        <input matInput formControlName="company">
      </mat-form-field>

      <!--Rol-->
      <mat-form-field class="form-field">
        <mat-label>Rol</mat-label>
        <mat-select formControlName="role">
          @for (role of roles; track role) {
          <mat-option [value]="role">{{ role }}</mat-option>
          }
        </mat-select>
      </mat-form-field>

      <!--Estado-->
      <div class="form-field">
        <mat-label>Estado</mat-label>
        <mat-checkbox formControlName="isActive">Activo</mat-checkbox>
      </div>

      <mat-dialog-actions align="end" class="dialog-actions">
        <button class="bg-primary px-4 py-2 rounded-full text-white hover:bg-primary/80 mr-4" (click)="onCancel()"
          [disabled]="loading">Cancelar</button>
        <button class="bg-primary px-4 py-2 rounded-full text-white hover:bg-primary/80" type="submit"
          [disabled]="userForm.invalid || loading">
          @if (loading) {
          <mat-spinner diameter="20" class="button-loading"></mat-spinner>
          } @else {
          {{ data?.user ? 'Actualizar' : 'Crear' }}
          }
        </button>
      </mat-dialog-actions>
    </form>
  </mat-dialog-content>
</section>